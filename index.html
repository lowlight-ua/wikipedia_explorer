<!DOCTYPE html>
<html>
<head>
<style>
</style>

<script src="http://viz-js.com/bower_components/viz.js/viz.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
<script src="model.js"></script>
<script src="api_base.js"></script>
<script src="api_phase1.js"></script>
<script src="api_phase2.js"></script>
<script src="api_phase3.js"></script>
<script src="analysis.js"></script>
<script src="output.js"></script>
<script src="wikipedia_explorer.js"></script>
<script>

function onGoClick() {
    let thePage = $("#pagetitle").val();
    if (thePage.length == 0) {
        return;
    }

    let guiCallbacks = {
        onProcessBegin, 
        onProcessEnd,
        setStatus
    };
    expl = new Explorer(guiCallbacks);
    expl.run(thePage);
}

function onProcessBegin() {
    $("#progress_div").html("");
    $("#output_div").html("");
    $("#wait_anim").show();
}

function onProcessEnd(svg) {
    $("#progress_div").html("");
    $("#output_div").html(svg);
    $("#wait_anim").hide();

    const thisObj = this;
    $('text').click(function() {
        const item = $(this);
        const href = item.parent().attr('xlink:href');
        const title = item.text();
        $('#pagetitle').val(title);
        onGoClick();
        return false;
    });
}

function setStatus(str) {
    $("#progress_div").html(str);
}

$(document).ready(function() {   
    $("#wait_anim").hide(); 
    $("#gobutton").click(onGoClick);

    $("#pagetitle").autocomplete({
        source: function(request, response) {
            $.ajax({
                url: "http://en.wikipedia.org/w/api.php",
                dataType: "jsonp",
                data: {
                    'action': "opensearch",
                    'format': "json",
                    'search': request.term
                },
                success: function(data) {
                    response(data[1]);
                }
            });
        }
    }).keyup(function(e) {
        if(e.keyCode == 13) {
            $("#pagetitle").autocomplete( "close" );
            onGoClick();
        }
    });
});

</script>

</head>

<body>

<div class="ui-widget">
Enter a title of an english Wikipedia article. Click "Explore" to see a graph of related articles and categories.
</div><BR>
<input type="text" class="ui-widget" style="width: 500px;" id="pagetitle">
<input type="button" id="gobutton" class="ui-widget" value="     Explore     "> <BR><BR>
<img id="wait_anim" src="https://i.stack.imgur.com/FhHRx.gif"> 

<pre id="progress_div"></pre>
<div id="output_div"></div>

</body>

</html>
